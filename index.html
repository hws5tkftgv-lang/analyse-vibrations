<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Poulies & courroie ‚Äî Animation r√©elle</title>

<style>
body{
  margin:0;
  background:#0b1436;
  color:#eaf1ff;
  font-family:Arial,sans-serif;
}
header{
  padding:14px;
  background:#0f1a44;
}
h1{margin:0;font-size:18px}

.panel{
  padding:14px;
  display:grid;
  gap:12px;
}

label{font-size:13px;opacity:.85}
input{
  width:100%;
  padding:10px;
  font-size:16px;
  border:none;
  border-radius:8px;
}

canvas{
  display:block;
  margin:10px auto;
  background:#000;
  border-radius:12px;
}

.info{
  padding:14px;
  background:#0f1a44;
  font-size:14px;
}

.error{
  color:#ff6b6b;
  font-weight:bold;
}
</style>
</head>

<body>

<header>
  <h1>üîÑ Poulies & courroie ‚Äî Animation physique r√©elle</h1>
</header>

<div class="panel">
  <label>RPM moteur (menante)
    <input id="rpm" type="number" value="1200">
  </label>

  <label>√ò poulie menante (mm)
    <input id="d1" type="number" value="100">
  </label>

  <label>√ò poulie men√©e (mm)
    <input id="d2" type="number" value="200">
  </label>

  <label>Distance centre-√†-centre C (mm)
    <input id="c" type="number" value="250">
  </label>
</div>

<canvas id="scene" width="420" height="260"></canvas>
<div class="info" id="info"></div>

<script>
const canvas = document.getElementById("scene");
const ctx = canvas.getContext("2d");

let t0 = performance.now();

function draw(){
  const rpm1 = +rpm.value;
  const d1v = +d1.value;
  const d2v = +d2.value;
  const Cmm = +c.value;

  const r1 = d1v/2;
  const r2 = d2v/2;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(Cmm <= r1 + r2){
    info.innerHTML = `<div class="error">‚ùå Configuration impossible : C ‚â§ R‚ÇÅ + R‚ÇÇ (poulies qui se chevauchent)</div>`;
    return;
  }

  const rpm2 = rpm1 * (d1v/d2v);

  const omega1 = rpm1 * 2*Math.PI/60;
  const omega2 = rpm2 * 2*Math.PI/60;

  const t = (performance.now()-t0)/1000;

  const x1 = 100;
  const x2 = x1 + (Cmm/250)*200;
  const y  = canvas.height/2;

  const theta = Math.acos((r2-r1)/Cmm);
  const alpha = Math.atan2(0, x2-x1);

  const a1 = alpha + theta;
  const a2 = alpha - theta;

  const P1 = {x:x1+r1*Math.cos(a1),y:y+r1*Math.sin(a1)};
  const P2 = {x:x1+r1*Math.cos(a2),y:y+r1*Math.sin(a2)};
  const G1 = {x:x2+r2*Math.cos(a1),y:y+r2*Math.sin(a1)};
  const G2 = {x:x2+r2*Math.cos(a2),y:y+r2*Math.sin(a2)};

  ctx.strokeStyle="#aaa";
  ctx.lineWidth=3;
  ctx.beginPath();
  ctx.moveTo(P1.x,P1.y); ctx.lineTo(G1.x,G1.y);
  ctx.moveTo(P2.x,P2.y); ctx.lineTo(G2.x,G2.y);
  ctx.stroke();

  function pulley(x,y,r,color,omega){
    ctx.save();
    ctx.translate(x,y);
    ctx.rotate(-omega*t);
    ctx.strokeStyle=color;
    ctx.lineWidth=3;
    ctx.beginPath();
    ctx.arc(0,0,r,0,Math.PI*2);
    ctx.stroke();
    ctx.fillStyle=color;
    ctx.beginPath();
    ctx.arc(r-4,0,4,0,Math.PI*2);
    ctx.fill();
    ctx.restore();
  }

  pulley(x1,y,r1,"#00a2ff",omega1);
  pulley(x2,y,r2,"#ff9800",omega2);

  const v_ms = Math.PI*(d1v/1000)*rpm1/60;
  const v_ftmin = v_ms*196.85;

  info.innerHTML = `
  üîµ Menante : ${rpm1.toFixed(1)} RPM ¬∑ ${(rpm1/60).toFixed(3)} Hz ¬∑ ${rpm1.toFixed(1)} FPM<br>
  üü† Men√©e : ${rpm2.toFixed(1)} RPM ¬∑ ${(rpm2/60).toFixed(3)} Hz ¬∑ ${rpm2.toFixed(1)} FPM<br>
  üßµ Courroie : ${v_ms.toFixed(3)} m/s ¬∑ ${v_ftmin.toFixed(1)} ft/min
  `;

  requestAnimationFrame(draw);
}

draw();
</script>

</body>
</html>