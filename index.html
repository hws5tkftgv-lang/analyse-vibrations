<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Analyse de vibrations ‚Äì Poulies & courroie</title>

<style>
body{
  margin:0;
  background:#0b1436;
  color:#eaf1ff;
  font-family:Arial, sans-serif;
}
header{
  padding:14px;
  background:#0f1a44;
  border-bottom:1px solid rgba(255,255,255,.15);
}
h1{ font-size:18px; margin:0; }
.panel{
  padding:14px;
  background:#101a40;
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:10px;
}
label{ font-size:13px; opacity:.85; }
input, select{
  width:100%;
  padding:8px;
  font-size:15px;
  border-radius:8px;
  border:none;
}
canvas{
  display:block;
  margin:0 auto;
  background:#000;
}
.info{
  padding:14px;
  font-size:14px;
  background:#0f1a44;
}
</style>
</head>

<body>

<header>
  <h1>üîÑ Analyse de vibrations ‚Äì Poulies & courroie</h1>
</header>

<div class="panel">
  <label>RPM moteur (menante)
    <input id="rpm" type="number" value="1200">
  </label>

  <label>Syst√®me d‚Äôunit√©s
    <select id="unit">
      <option value="metric">M√©trique (mm)</option>
      <option value="imperial">Imp√©rial (po)</option>
    </select>
  </label>

  <label>√ò poulie menante
    <input id="d1" type="number" value="100">
  </label>

  <label>√ò poulie men√©e
    <input id="d2" type="number" value="200">
  </label>
</div>

<canvas id="scene" width="420" height="260"></canvas>
<div class="info" id="info"></div>

<script>
const canvas = document.getElementById("scene");
const ctx = canvas.getContext("2d");

const rpmInput = document.getElementById("rpm");
const d1Input  = document.getElementById("d1");
const d2Input  = document.getElementById("d2");
const unitSel  = document.getElementById("unit");
const info     = document.getElementById("info");

let angle1 = 0;
let angle2 = 0;

function toMM(v){
  return unitSel.value === "imperial" ? v * 25.4 : v;
}

function drawBelt(x1,y1,r1,x2,y2,r2){
  const dx = x2 - x1;
  const dy = y2 - y1;
  const D  = Math.hypot(dx, dy);
  if(D <= Math.abs(r2 - r1)) return;

  const theta = Math.atan2(dy, dx);
  const alpha = Math.acos((r2 - r1) / D);

  const g1 = theta + alpha;
  const g2 = theta - alpha;
  const p1 = theta + Math.PI - alpha;
  const p2 = theta + Math.PI + alpha;

  const G1 = { x: x2 + r2*Math.cos(g1), y: y2 + r2*Math.sin(g1) };
  const G2 = { x: x2 + r2*Math.cos(g2), y: y2 + r2*Math.sin(g2) };
  const P1 = { x: x1 + r1*Math.cos(p1), y: y1 + r1*Math.sin(p1) };
  const P2 = { x: x1 + r1*Math.cos(p2), y: y1 + r1*Math.sin(p2) };

  ctx.strokeStyle="#777";
  ctx.lineWidth=4;
  ctx.beginPath();
  ctx.moveTo(P1.x,P1.y);
  ctx.lineTo(G1.x,G1.y);
  ctx.arc(x2,y2,r2,g1,g2,false);
  ctx.lineTo(P2.x,P2.y);
  ctx.arc(x1,y1,r1,p2,p1,false);
  ctx.stroke();
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const rpm = +rpmInput.value;
  const d1  = toMM(+d1Input.value);
  const d2  = toMM(+d2Input.value);

  const rpm2 = rpm * (d1/d2);
  const hz1  = rpm / 60;
  const hz2  = rpm2 / 60;

  const x1 = 130, x2 = 320, y = 130;
  const r1 = 32;
  const r2 = r1 * (d2/d1);

  // Courroie (TOUJOURS EN PREMIER)
  drawBelt(x1,y,r1,x2,y,r2);

  // Poulie menante
  ctx.save();
  ctx.translate(x1,y);
  ctx.rotate(angle1);
  ctx.strokeStyle="#00a2ff";
  ctx.lineWidth=3;
  ctx.beginPath();
  ctx.arc(0,0,r1,0,Math.PI*2);
  ctx.stroke();
  ctx.fillStyle="#00a2ff";
  ctx.beginPath();
  ctx.arc(r1-4,0,4,0,Math.PI*2);
  ctx.fill();
  ctx.restore();

  // Poulie men√©e
  ctx.save();
  ctx.translate(x2,y);
  ctx.rotate(angle2);
  ctx.strokeStyle="#ff9800";
  ctx.lineWidth=3;
  ctx.beginPath();
  ctx.arc(0,0,r2,0,Math.PI*2);
  ctx.stroke();
  ctx.fillStyle="#ff9800";
  ctx.beginPath();
  ctx.arc(r2-4,0,4,0,Math.PI*2);
  ctx.fill();
  ctx.restore();

  info.innerHTML = `
  üîµ Menante : ${rpm.toFixed(0)} RPM / ${hz1.toFixed(2)} Hz<br>
  üü† Men√©e : ${rpm2.toFixed(0)} RPM / ${hz2.toFixed(2)} Hz<br>
  üìê Unit√©s : ${unitSel.value === "metric" ? "mm" : "po"}
  `;

  angle1 += hz1 * 0.04;
  angle2 += hz2 * 0.04;

  requestAnimationFrame(draw);
}

draw();
</script>

</body>
</html>