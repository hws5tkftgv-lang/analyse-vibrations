<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>Analyse de vibrations â€” Poulies & courroie</title>

<style>
:root{
  --bg:#0b1436;
  --panel:#101a40;
  --panel2:#0f1a44;
  --text:#eaf1ff;
  --muted:rgba(234,241,255,.75);
  --blue:#00a2ff;
  --orange:#ff9800;
}
*{ box-sizing:border-box; }
html,body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Arial,system-ui,sans-serif;
}

header{
  padding:14px;
  background:linear-gradient(180deg,#0f1a44,#0b1436);
  border-bottom:1px solid rgba(255,255,255,.12);
}
h1{ margin:0; font-size:18px; }

.panel{
  padding:14px;
  background:var(--panel);
  display:grid;
  gap:14px;
}

.row2{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
@media(max-width:520px){
  .row2{ grid-template-columns:1fr; }
}

label{
  font-size:13px;
  color:var(--muted);
}
.field{
  margin-top:6px;
  width:100%;
  padding:12px;
  font-size:16px;
  border-radius:10px;
  border:none;
}

.stageWrap{ padding:12px; }
canvas{
  width:100%;
  background:#000;
  border-radius:14px;
}

.info{
  padding:14px;
  background:var(--panel2);
  border-top:1px solid rgba(255,255,255,.12);
  font-size:14px;
  line-height:1.45;
}

.dot{
  display:inline-block;
  width:12px;height:12px;
  border-radius:50%;
  margin-right:6px;
}
.blue{ background:var(--blue); }
.orange{ background:var(--orange); }
.white{ background:#fff; }
.muted{ color:var(--muted); }

.sliderVal{
  text-align:right;
  font-size:13px;
  color:var(--muted);
}
</style>
</head>

<body>
<header>
  <h1>ðŸ”„ Analyse de vibrations â€” Poulies & courroie</h1>
</header>

<div class="panel">

  <label>RPM moteur (menante)
    <input id="rpm" class="field" type="number" value="1200">
  </label>

  <label>SystÃ¨me dâ€™unitÃ©s
    <select id="unit" class="field">
      <option value="metric">MÃ©trique (mm)</option>
      <option value="imperial">ImpÃ©rial (po)</option>
    </select>
  </label>

  <div class="row2">
    <label>Ã˜ poulie menante
      <input id="d1" class="field" type="number" value="100">
    </label>
    <label>Ã˜ poulie menÃ©e
      <input id="d2" class="field" type="number" value="400">
    </label>
  </div>

  <label>Distance centre-Ã -centre
    <input id="cc" class="field" type="number" value="320">
  </label>

  <!-- CONTROLE RALENTI -->
  <label>Ralenti animation
    <input id="slow" type="range" min="0.25" max="2" step="0.25" value="1">
    <div class="sliderVal" id="slowVal">Ã—1.00</div>
  </label>

</div>

<div class="stageWrap">
  <canvas id="scene"></canvas>
</div>

<div class="info" id="info"></div>

<script>
(() => {
const canvas = document.getElementById("scene");
const ctx = canvas.getContext("2d");

const rpmEl = document.getElementById("rpm");
const unitEl = document.getElementById("unit");
const d1El = document.getElementById("d1");
const d2El = document.getElementById("d2");
const ccEl = document.getElementById("cc");
const slowEl = document.getElementById("slow");
const slowVal = document.getElementById("slowVal");
const infoEl = document.getElementById("info");

const TAU = Math.PI*2;
const IN_TO_MM = 25.4;

let lastTS=null;
let t=0;

function resize(){
  const w=Math.min(window.innerWidth-24,720);
  const h=w*0.6;
  const dpr=Math.min(3,window.devicePixelRatio||1);
  canvas.style.width=w+"px";
  canvas.style.height=h+"px";
  canvas.width=w*dpr;
  canvas.height=h*dpr;
  ctx.setTransform(dpr,0,0,dpr,0,0);
}

function loop(ts){
  if(!lastTS) lastTS=ts;
  const dt=(ts-lastTS)/1000;
  lastTS=ts;
  t+=dt/parseFloat(slowEl.value);
  draw();
  requestAnimationFrame(loop);
}

function draw(){
  const rpm=+rpmEl.value||0;
  let d1=+d1El.value||1;
  let d2=+d2El.value||1;
  if(unitEl.value==="imperial"){
    d1*=IN_TO_MM;
    d2*=IN_TO_MM;
  }

  const f1=rpm/60;
  const rpm2=rpm*(d1/d2);
  const f2=rpm2/60;

  const w1=TAU*f1;
  const w2=TAU*f2;

  const v_mm_min=rpm*Math.PI*d1;
  const v_mm_s=v_mm_min/60;
  const f_lin=v_mm_s/(Math.PI*d1);
  const cpm_lin=f_lin*60;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  infoEl.innerHTML=`
  <div><span class="dot blue"></span><b>Poulie menante</b> :
  ${rpm.toFixed(0)} RPM | ${f1.toFixed(2)} Hz | ${(f1*60).toFixed(0)} CPM</div>

  <div><span class="dot orange"></span><b>Poulie menÃ©e</b> :
  ${rpm2.toFixed(0)} RPM | ${f2.toFixed(2)} Hz | ${(f2*60).toFixed(0)} CPM</div>

  <div class="muted" style="margin-top:8px;">
  <span class="dot white"></span><b>Courroie (linÃ©aire)</b><br>
  ${v_mm_min.toFixed(0)} ${unitEl.value==="imperial"?"po":"mm"}/min<br>
  ${f_lin.toFixed(2)} Hz | ${cpm_lin.toFixed(0)} CPM
  </div>
  `;
}

slowEl.addEventListener("input",()=>{
  slowVal.textContent="Ã—"+parseFloat(slowEl.value).toFixed(2);
});

window.addEventListener("resize",resize);
resize();
requestAnimationFrame(loop);
})();
</script>
</body>
</html>