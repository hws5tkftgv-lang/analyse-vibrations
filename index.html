<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport"
content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<title>Poulies & courroie ‚Äî p√©dagogie</title>

<style>
:root{
  --bg:#0b1436;
  --panel:#101a40;
  --text:#eaf1ff;
  --muted:rgba(234,241,255,.65);
  --blue:#00a2ff;
  --orange:#ff9800;
}
*{ box-sizing:border-box; }
html,body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Arial,system-ui,sans-serif;
}

header{
  padding:10px 14px;
  font-size:16px;
  font-weight:700;
}

.controls, .results{
  padding:10px 14px;
}

.controls{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:8px;
}

.controls label{
  font-size:12px;
  color:var(--muted);
}

.controls input, .controls select{
  width:100%;
  padding:6px 8px;
  font-size:14px;
  border-radius:6px;
  border:none;
}

.buttons{
  display:flex;
  gap:10px;
  padding:10px 14px;
}

button{
  flex:1;
  padding:10px;
  font-size:15px;
  border:none;
  border-radius:8px;
  background:#1c2b6a;
  color:white;
}

.stage{
  padding:10px 14px;
}

canvas{
  width:100%;
  background:black;
  border-radius:12px;
}

.results{
  font-size:14px;
  line-height:1.5;
}

.dot{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:6px;}
.blue{background:var(--blue);}
.orange{background:var(--orange);}
.white{background:#fff;}
</style>
</head>

<body>

<header>üîÑ Poulies & courroie ‚Äî simulation</header>

<div class="controls">
  <label>RPM moteur
    <input id="rpm" type="number" value="0">
  </label>

  <label>Unit√©s
    <select id="unit">
      <option value="metric">mm</option>
      <option value="imperial">po</option>
    </select>
  </label>

  <label>√ò menante
    <input id="d1" type="number" value="0">
  </label>

  <label>√ò men√©e
    <input id="d2" type="number" value="0">
  </label>

  <label>C-C
    <input id="cc" type="number" value="0">
  </label>
</div>

<div class="buttons">
  <button id="play">‚ñ∂Ô∏è Play</button>
  <button id="pause">‚è∏ Pause</button>
  <button id="reset">üîÑ Reset</button>
</div>

<div class="stage">
  <canvas id="scene"></canvas>
</div>

<div class="results" id="info"></div>

<script>
(() => {
const canvas = document.getElementById("scene");
const ctx = canvas.getContext("2d");

const rpmEl = document.getElementById("rpm");
const d1El = document.getElementById("d1");
const d2El = document.getElementById("d2");
const ccEl = document.getElementById("cc");
const unitEl = document.getElementById("unit");
const infoEl = document.getElementById("info");

const playBtn = document.getElementById("play");
const pauseBtn = document.getElementById("pause");
const resetBtn = document.getElementById("reset");

const TAU = Math.PI*2;
const IN_TO_MM = 25.4;

let t = 0;
let running = false;
let lastTS = null;
let lockedWidth = null;

function resize(){
  if(lockedWidth===null){
    lockedWidth = Math.min(window.innerWidth-24,720);
  }
  const w = lockedWidth;
  const h = w*0.6;
  const dpr = Math.min(3,window.devicePixelRatio||1);

  canvas.style.width=w+"px";
  canvas.style.height=h+"px";
  canvas.width=w*dpr;
  canvas.height=h*dpr;
  ctx.setTransform(dpr,0,0,dpr,0,0);
}
window.addEventListener("resize",resize);
resize();

playBtn.onclick = ()=> running=true;
pauseBtn.onclick = ()=> running=false;
resetBtn.onclick = ()=>{
  running=false;
  t=0;
  rpmEl.value=d1El.value=d2El.value=ccEl.value=0;
  draw();
};

function loop(ts){
  if(!lastTS) lastTS=ts;
  const dt=(ts-lastTS)/1000;
  lastTS=ts;
  if(running) t+=dt;
  draw();
  requestAnimationFrame(loop);
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="black";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  const rpm=+rpmEl.value||0;
  let d1=+d1El.value||0;
  let d2=+d2El.value||0;
  if(unitEl.value==="imperial"){ d1*=IN_TO_MM; d2*=IN_TO_MM; }

  const f1=rpm/60;
  const rpm2=d2?rpm*(d1/d2):0;
  const f2=rpm2/60;
  const v=rpm*Math.PI*d1;

  infoEl.innerHTML=`
  <div><span class="dot blue"></span>Menante : ${rpm.toFixed(0)} RPM | ${f1.toFixed(2)} Hz | ${(f1*60).toFixed(0)} CPM</div>
  <div><span class="dot orange"></span>Men√©e : ${rpm2.toFixed(0)} RPM | ${f2.toFixed(2)} Hz | ${(f2*60).toFixed(0)} CPM</div>
  <div><span class="dot white"></span>Courroie : ${v.toFixed(0)} ${unitEl.value==="imperial"?"po":"mm"}/min</div>
  `;
}

requestAnimationFrame(loop);
})();
</script>
</body>
</html>