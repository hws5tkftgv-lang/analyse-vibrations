<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Poulies & courroie â€” Animation rÃ©elle stable</title>

<style>
body{
  margin:0;
  background:#0b1436;
  color:#eaf1ff;
  font-family:Arial,sans-serif;
}
header{padding:14px;background:#0f1a44}
h1{margin:0;font-size:18px}

.panel{padding:14px;display:grid;gap:12px}
label{font-size:13px;opacity:.85}
input{width:100%;padding:10px;font-size:16px;border:none;border-radius:8px}

canvas{display:block;margin:10px auto;background:#000;border-radius:12px}

.info{padding:14px;background:#0f1a44;font-size:14px}
.error{color:#ff6b6b;font-weight:bold}
</style>
</head>

<body>

<header>
  <h1>ğŸ”„ Poulies & courroie â€” cinÃ©matique rÃ©elle</h1>
</header>

<div class="panel">
  <label>RPM moteur (menante)
    <input id="rpm" type="number" value="1200">
  </label>

  <label>Ã˜ poulie menante (mm)
    <input id="d1" type="number" value="100">
  </label>

  <label>Ã˜ poulie menÃ©e (mm)
    <input id="d2" type="number" value="200">
  </label>

  <label>Distance centre-Ã -centre C (mm)
    <input id="c" type="number" value="250">
  </label>
</div>

<canvas id="scene" width="420" height="260"></canvas>
<div class="info" id="info"></div>

<script>
const canvas = document.getElementById("scene");
const ctx = canvas.getContext("2d");
let startTime = performance.now();

function computeState(){
  const rpm1 = +rpm.value;
  const d1v = +d1.value;
  const d2v = +d2.value;
  const Cmm = +c.value;

  const r1 = d1v/2;
  const r2 = d2v/2;

  const rpm2 = rpm1 * (d1v/d2v);

  return {
    rpm1, rpm2, d1v, d2v, r1, r2, Cmm,
    omega1: rpm1*2*Math.PI/60,
    omega2: rpm2*2*Math.PI/60
  };
}

function isValid(state){
  return state.Cmm > (state.r1 + state.r2);
}

function drawScene(state, valid){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const t = (performance.now()-startTime)/1000;

  const x1 = 100;
  const x2 = x1 + (state.Cmm/250)*200;
  const y  = canvas.height/2;

  if(valid){
    const theta = Math.acos((state.r2-state.r1)/state.Cmm);
    const a1 = theta;
    const a2 = -theta;

    const P1 = {x:x1+state.r1*Math.cos(a1),y:y+state.r1*Math.sin(a1)};
    const P2 = {x:x1+state.r1*Math.cos(a2),y:y+state.r1*Math.sin(a2)};
    const G1 = {x:x2+state.r2*Math.cos(a1),y:y+state.r2*Math.sin(a1)};
    const G2 = {x:x2+state.r2*Math.cos(a2),y:y+state.r2*Math.sin(a2)};

    ctx.strokeStyle="#aaa";
    ctx.lineWidth=3;
    ctx.beginPath();
    ctx.moveTo(P1.x,P1.y); ctx.lineTo(G1.x,G1.y);
    ctx.moveTo(P2.x,P2.y); ctx.lineTo(G2.x,G2.y);
    ctx.stroke();
  }

  function pulley(x,y,r,color,omega){
    ctx.save();
    ctx.translate(x,y);
    ctx.rotate(-omega*t);
    ctx.strokeStyle=color;
    ctx.lineWidth=3;
    ctx.beginPath();
    ctx.arc(0,0,r,0,Math.PI*2);
    ctx.stroke();
    ctx.fillStyle=color;
    ctx.beginPath();
    ctx.arc(r-4,0,4,0,Math.PI*2);
    ctx.fill();
    ctx.restore();
  }

  pulley(x1,y,state.r1,"#00a2ff",state.omega1);
  pulley(x2,y,state.r2,"#ff9800",state.omega2);
}

function loop(){
  const state = computeState();
  const valid = isValid(state);

  drawScene(state, valid);

  if(!valid){
    info.innerHTML = `<div class="error">âŒ Configuration impossible : C â‰¤ Râ‚ + Râ‚‚</div>`;
  }else{
    const v = Math.PI*(state.d1v/1000)*state.rpm1/60;
    info.innerHTML = `
    ğŸ”µ Menante : ${state.rpm1.toFixed(1)} RPM Â· ${(state.rpm1/60).toFixed(3)} Hz Â· ${state.rpm1.toFixed(1)} FPM<br>
    ğŸŸ  MenÃ©e : ${state.rpm2.toFixed(1)} RPM Â· ${(state.rpm2/60).toFixed(3)} Hz Â· ${state.rpm2.toFixed(1)} FPM<br>
    ğŸ§µ Courroie : ${v.toFixed(3)} m/s Â· ${(v*196.85).toFixed(1)} ft/min
    `;
  }

  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>